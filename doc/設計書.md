# WebFOCUS REST アプリケーション 仕様書

## 1. プロジェクト概要

### 1.1 目的
WebFOCUS RESTful サービスを利用したポータルアプリケーションを開発し、WebFOCUSの情報リソースに容易にアクセスできるウェブインターフェースを提供する。

### 1.2 システム構成
- **フロントエンド**: React (TypeScript) + Vite
- **バックエンド**: WebFOCUS REST API (http://localhost:8080)
- **通信方式**: RESTful API

## 2. 機能仕様

### 2.1 認証機能
- WebFOCUSへのユーザー認証（ユーザーIDとパスワード）
- CSRFトークン管理
- ユーザー情報の取得と保持

### 2.2 リソース管理機能
- WebFOCUS IBFSリポジトリからのリソース一覧取得
- フォルダ階層の表示と操作
- リソースタイプに基づいた表示

### 2.3 UI機能
- ログイン画面
- メインポータル画面
  - ナビゲーション領域
  - コンテンツ表示領域
- リソース表示コンポーネント（カードグリッド表示）

## 3. 技術仕様

### 3.1 アーキテクチャ
- **コンポーネント設計**: React関数コンポーネントとTypeScript型定義
- **状態管理**: React Hooksを使用した状態管理
- **APIサービス**: WebFocusServiceクラスによるREST API通信のカプセル化

### 3.2 主要コンポーネント
1. **App**: アプリケーションのルートコンポーネント、認証状態管理
2. **Login**: ユーザー認証フォームコンポーネント
3. **MainLayout**: 認証後のメインポータルレイアウト
4. **FolderCardGrid**: IBFSリソースのカード表示

### 3.3 WebFOCUS通信サービス
- **サービスクラス**: WebFocusService
- **主要API**:
  - login(username, password): WebFOCUSへの認証
  - getResourceItems(path): 指定パスのリソース取得

### 3.4 開発環境設定
- **Viteプロキシ**: WebFOCUS APIへのクロスオリジン通信を処理
  - ターゲット: http://localhost:8080
  - パス: /ibi_apps

## 4. データ構造

### 4.1 主要インターフェース

#### LoginResult
```typescript
interface LoginResult {
  success: boolean;
  message: string;
  userDisplayName?: string | null;
  userFullPath?: string | null;
  csrfTokenName?: string | null;
  csrfTokenValue?: string | null;
}
```

#### FolderItem
```typescript
interface FolderItem {
  name: string;
  description: string | null;
  fullPath: string;
  type: string;
  typeDescription: string;
  thumbPath: string;
  createdBy: string;
  lastModified: string;
  container: boolean;
}
```

#### ResourceResult
```typescript
interface ResourceResult {
  success: boolean;
  message: string;
  items: FolderItem[];
}
```

## 5. シーケンス

### 5.1 ログインフロー
1. ユーザーがログインフォームにユーザー名とパスワードを入力
2. WebFocusService.loginメソッドが呼び出される
3. サービスが'/ibi_apps/rs'へのPOSTリクエストを実行
4. 成功時:
   - ユーザー情報とCSRFトークンを抽出・保存
   - 認証状態をtrueに設定
   - メインレイアウトを表示
5. 失敗時:
   - エラーメッセージを表示

### 5.2 リソース取得フロー
1. ユーザーが「ワークスペース」をクリック
2. WebFocusService.getResourceItemsメソッドが呼び出される
3. サービスが'/ibi_apps/rs'へのGETリクエストを実行
4. 成功時:
   - 取得したフォルダアイテムをstate更新
   - FolderCardGridコンポーネントで表示
5. 失敗時:
   - エラーメッセージを表示

## 6. 今後の拡張計画
- リソース詳細表示機能
- レポート実行機能
- ダッシュボード表示機能
- ユーザー設定機能

## 7. 技術的制約事項
- WebFOCUS REST APIの仕様に依存
- XMLレスポンスの解析処理が必要
- CSRFトークン対応が必要
- ブラウザのCORS制約に対応するためのプロキシ設定が必要